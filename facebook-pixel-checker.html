<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verificador de Pixel de Facebook - M√©todo 3R</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status {
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .log {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Verificador de Pixel de Facebook</h1>
        <p>Esta herramienta te ayudar√° a verificar si el Pixel de Facebook est√° correctamente instalado en tu landing page.</p>

        <div class="test-section">
            <h2>üìã Verificaciones Autom√°ticas</h2>
            <div id="autoChecks"></div>
        </div>

        <div class="test-section">
            <h2>üß™ Pruebas Manuales</h2>
            <p>Haz clic en estos botones para simular eventos y verificar que el Pixel los capture:</p>
            <button onclick="testPageView()">üìÑ Probar PageView</button>
            <button onclick="testAddToCart()">üõí Probar AddToCart</button>
            <button onclick="testPurchase()">üí∞ Probar Purchase</button>
            <button onclick="testLead()">üìû Probar Lead</button>
            <button onclick="testCompleteRegistration()">üìù Probar CompleteRegistration</button>
        </div>

        <div class="test-section">
            <h2>üìä Log de Eventos</h2>
            <div id="eventLog" class="log"></div>
        </div>

        <div class="test-section">
            <h2>üîß Herramientas de Verificaci√≥n</h2>
            <button onclick="openFacebookPixelHelper()">üîç Abrir Facebook Pixel Helper</button>
            <button onclick="openGoogleTagAssistant()">üîç Abrir Google Tag Assistant</button>
            <button onclick="checkNetworkRequests()">üåê Verificar Llamadas de Red</button>
        </div>

        <div class="test-section">
            <h2>üìù Instrucciones</h2>
            <ol>
                <li><strong>Verifica el c√≥digo:</strong> Aseg√∫rate de que el Pixel ID est√© correctamente configurado</li>
                <li><strong>Prueba los eventos:</strong> Haz clic en los botones de prueba</li>
                <li><strong>Revisa Facebook Business Manager:</strong> Ve a Eventos en tiempo real</li>
                <li><strong>Usa Facebook Pixel Helper:</strong> Instala la extensi√≥n del navegador</li>
            </ol>
        </div>
    </div>

    <script>
        // Funci√≥n para agregar logs
        function addLog(message, type = 'info') {
            const log = document.getElementById('eventLog');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            logEntry.style.color = type === 'error' ? 'red' : type === 'success' ? 'green' : 'black';
            log.insertBefore(logEntry, log.firstChild);
        }

        // Verificaciones autom√°ticas
        function runAutoChecks() {
            const checksDiv = document.getElementById('autoChecks');
            let checks = '';

            // Verificar si fbq est√° definido
            if (typeof fbq !== 'undefined') {
                checks += '<div class="status success">‚úÖ fbq est√° definido</div>';
                addLog('‚úÖ fbq est√° definido', 'success');
            } else {
                checks += '<div class="status error">‚ùå fbq NO est√° definido</div>';
                addLog('‚ùå fbq NO est√° definido', 'error');
            }

            // Verificar si el Pixel est√° inicializado
            if (typeof fbq !== 'undefined' && fbq.loaded) {
                checks += '<div class="status success">‚úÖ Pixel de Facebook cargado</div>';
                addLog('‚úÖ Pixel de Facebook cargado', 'success');
            } else {
                checks += '<div class="status warning">‚ö†Ô∏è Pixel de Facebook no est√° cargado</div>';
                addLog('‚ö†Ô∏è Pixel de Facebook no est√° cargado', 'warning');
            }

            // Verificar si hay llamadas de red a Facebook
            setTimeout(() => {
                const performance = window.performance;
                const entries = performance.getEntriesByType('resource');
                const facebookCalls = entries.filter(entry => 
                    entry.name.includes('facebook.com') || 
                    entry.name.includes('fbcdn.net')
                );
                
                if (facebookCalls.length > 0) {
                    checks += '<div class="status success">‚úÖ Llamadas a Facebook detectadas</div>';
                    addLog(`‚úÖ ${facebookCalls.length} llamadas a Facebook detectadas`, 'success');
                } else {
                    checks += '<div class="status warning">‚ö†Ô∏è No se detectaron llamadas a Facebook</div>';
                    addLog('‚ö†Ô∏è No se detectaron llamadas a Facebook', 'warning');
                }
            }, 2000);

            checksDiv.innerHTML = checks;
        }

        // Funciones de prueba
        function testPageView() {
            if (typeof fbq !== 'undefined') {
                fbq('track', 'PageView');
                addLog('üìÑ Evento PageView enviado', 'success');
            } else {
                addLog('‚ùå fbq no est√° disponible', 'error');
            }
        }

        function testAddToCart() {
            if (typeof fbq !== 'undefined') {
                fbq('track', 'AddToCart', {
                    content_ids: ['metodo3r'],
                    content_name: 'M√©todo 3R',
                    value: 27.00,
                    currency: 'USD'
                });
                addLog('üõí Evento AddToCart enviado', 'success');
            } else {
                addLog('‚ùå fbq no est√° disponible', 'error');
            }
        }

        function testPurchase() {
            if (typeof fbq !== 'undefined') {
                fbq('track', 'Purchase', {
                    content_ids: ['metodo3r'],
                    content_name: 'M√©todo 3R',
                    value: 27.00,
                    currency: 'USD'
                });
                addLog('üí∞ Evento Purchase enviado', 'success');
            } else {
                addLog('‚ùå fbq no est√° disponible', 'error');
            }
        }

        function testLead() {
            if (typeof fbq !== 'undefined') {
                fbq('track', 'Lead', {
                    content_name: 'M√©todo 3R Lead',
                    value: 27.00,
                    currency: 'USD'
                });
                addLog('üìû Evento Lead enviado', 'success');
            } else {
                addLog('‚ùå fbq no est√° disponible', 'error');
            }
        }

        function testCompleteRegistration() {
            if (typeof fbq !== 'undefined') {
                fbq('track', 'CompleteRegistration', {
                    content_name: 'Test de Ansiedad Funcional',
                    value: 0.00,
                    currency: 'USD'
                });
                addLog('üìù Evento CompleteRegistration enviado', 'success');
            } else {
                addLog('‚ùå fbq no est√° disponible', 'error');
            }
        }

        // Funciones de herramientas
        function openFacebookPixelHelper() {
            window.open('https://chrome.google.com/webstore/detail/facebook-pixel-helper/fdgfkebogiimcoedlicjlajpkdmockpc', '_blank');
            addLog('üîç Abriendo Facebook Pixel Helper', 'info');
        }

        function openGoogleTagAssistant() {
            window.open('https://chrome.google.com/webstore/detail/google-tag-assistant-legacy/jgknkdbozlcckddlgpepahodjaplhhma', '_blank');
            addLog('üîç Abriendo Google Tag Assistant', 'info');
        }

        function checkNetworkRequests() {
            const performance = window.performance;
            const entries = performance.getEntriesByType('resource');
            const facebookRequests = entries.filter(entry => 
                entry.name.includes('facebook.com') || 
                entry.name.includes('fbcdn.net')
            );
            
            addLog(`üåê ${facebookRequests.length} llamadas a Facebook encontradas:`, 'info');
            facebookRequests.forEach((request, index) => {
                addLog(`  ${index + 1}. ${request.name}`, 'info');
            });
        }

        // Ejecutar verificaciones al cargar
        window.addEventListener('load', function() {
            addLog('üöÄ P√°gina cargada, iniciando verificaciones...', 'info');
            setTimeout(runAutoChecks, 1000);
        });

        // Interceptar llamadas a fbq para logging
        if (typeof fbq !== 'undefined') {
            const originalFbq = fbq;
            fbq = function(...args) {
                addLog(`üì° fbq llamado: ${args[0]} ${JSON.stringify(args.slice(1))}`, 'info');
                return originalFbq.apply(this, args);
            };
        }
    </script>
</body>
</html> 